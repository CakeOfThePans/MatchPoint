// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Tournament {
  tournament_id     Int      @id @default(autoincrement())
  tournament_name   String   @unique
  surface_type      String
  is_grand_slam     Boolean  @default(false)
  last_updated      DateTime 

  // Relations
  matches           Match[]
  ml_results        MLResultByTournament[]
}

model Match {
  match_id                  Int      @id
  name                      String
  surface_type              String
  status_type               String
  home_team_id              Int
  home_team_name            String
  home_team_hash_image      String
  away_team_id              Int
  away_team_name            String
  away_team_hash_image      String
  start_time                DateTime
  score                     String?
  winner_id                 Int?
  winner_name               String?
  tournament_id             Int
  prediction_model          Int?
  winner_prediction_id      Int?
  home_team_prediction_prob Float?
  away_team_prediction_prob Float?
  home_team_odds            Float?
  away_team_odds            Float?

  // Relations
  tournament                Tournament  @relation(fields: [tournament_id], references: [tournament_id])
  home_team                 Player      @relation("HomeTeamMatches", fields: [home_team_id], references: [player_id])
  away_team                 Player      @relation("AwayTeamMatches", fields: [away_team_id], references: [player_id])
  winner                    Player?     @relation("WinnerMatches", fields: [winner_id], references: [player_id])
}


model Player {
  player_id         Int      @id @default(autoincrement())
  name              String
  hash_image        String?
  birth_date        DateTime?
  height            Int?
  weight            Int?
  plays             String?
  rank              Int?
  points            Int?

  // Relations
  home_matches      Match[]  @relation("HomeTeamMatches")
  away_matches      Match[]  @relation("AwayTeamMatches")
  won_matches       Match[]  @relation("WinnerMatches")
}

model MLResultOverall {
  id Int @id @default(1)
  correct_predictions Int
  incorrect_predictions Int
}

model MLResultByTournament {
  id Int @id @default(autoincrement())
  tournament_id Int @unique
  correct_predictions Int
  incorrect_predictions Int

  // Relations  
  tournament Tournament @relation(fields: [tournament_id], references: [tournament_id])
}